<!DOCTYPE HTML>
<html>
  <head>
    <script src="https://cdn-webgl.wrld3d.com/wrldjs/dist/latest/wrld.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.1/leaflet.css" rel="stylesheet" />
    <style>
      #floorButtons {
        position: absolute;
        z-index: 20;
      }

      #floorButtons button {
        display: block;
        width: 100%;
      }
    </style>
  </head>
  
  <body>
  <div style="position: relative">
  	<div id="floorButtons">
      <button type="button" onclick="topFloor()">Top Floor</button>
      <button type="button" onclick="moveUp()">Move Up</button>
      <button type="button" onclick="moveDown()">Move Down</button>
      <button type="button" onclick="bottomFloor()">Bottom Floor</button>
      <button type="button" onclick="exitIndoors()">Exit</button>
      <button type="button" onclick="expandFloors()">Exit</button>
      <button type="button" onclick="collapseFloors()">Exit</button>
    </div>

    <div id="map" style="height: 600px"></div>

    <script>
      var map = L.Wrld.map("map", "9d876646f7d83cc709edbe204c81d546", {
        center: [56.4598, -2.9728],
        zoom: 17,
        indoorsEnabled: true
      });

      var entityIdsToColorIndex = {};
      var colors = [
          [255, 0, 0, 128],
          [0, 255, 0, 128],
          [0, 0, 255, 128]
      ];

      function onIndoorEntityClicked(event){
      	event.ids.forEach(highlight);
      }


      //------Not compatible with floor buttons----------
      /*//Displaying the name of an indoor map
      function onIndoorMapEntered(event) {       
        var latLng = map.getCenter();        
        var indoorMapId = event.indoorMap.getIndoorMapId();
        var buildingName = event.indoorMap.getIndoorMapName();
        
        var popupOptions = { 
          indoorMapId: indoorMapId, 
          indoorMapFloorIndex: 0, 
          autoClose: false, 
          closeOnClick: false 
        };
        
        var popup = L.popup(popupOptions)
          .setLatLng(latLng)
          .addTo(map)
          .setContent(buildingName);
        
        map.on("popupclose", function() { map.indoors.exit(); })
      }*/
      
      //highlights rooms when clicked
      function highlight(id) {
        entityIdsToColorIndex[id] = entityIdsToColorIndex[id] === undefined ? 0 : (entityIdsToColorIndex[id] + 1) % colors.length;
        map.indoors.setEntityHighlights(id, colors[entityIdsToColorIndex[id]]);
      }

      function topFloor() {
        var indoorMap = map.indoors.getActiveIndoorMap();
        if (indoorMap) {
          map.indoors.setFloor(indoorMap.getFloorCount() - 1);
        }
      }

      function moveUp() {
        map.indoors.moveUp();
      }

      function moveDown() {
        map.indoors.moveDown();
      }

      function bottomFloor() {
        map.indoors.setFloor(0);
      }

      function exitIndoors() {
        map.indoors.exit();
      }

      function exitIndoors()

      function exitIndoors()

      function onEnter(event) {
    	console.log("Entered indoor map: " + event.indoorMap.getIndoorMapName());
	  }


      //map.indoors.on("indoormapenter", onIndoorMapEntered);
      map.indoors.on("indoorentityclick", onIndoorEntityClicked);
      map.indoors.on("indoormapenter", onEnter);

    </script>

  </div>
  </body>
</html>